import{S as ae,i as oe,s as ne,e as E,j as N,c as T,a as y,l as R,d as k,b as n,Q as J,f as Q,I as _,R as V,T as W,U as le,V as se,W as re,X as ie,Y as $,Z as ue,t as de,M as ce,g as fe,K as _e,o as he,p as pe,n as me,_ as ve,$ as x,m as be,a0 as ge,D as ke}from"../../chunks/vendor-fb7309c6.js";function C(u,{pending:t,error:e,result:a}){let h;async function j(p){const c=h={};p.preventDefault();const v=new FormData(u);t&&t(v,u);try{const r=await fetch(u.action,{method:u.method,headers:{accept:"application/json"},body:v});if(c!==h)return;r.ok?a(r,u):e?e(r,null,u):console.error(await r.text())}catch(r){if(e)e(null,r,u);else throw r}}return u.addEventListener("submit",j),{destroy(){u.removeEventListener("submit",j)}}}function ee(u,t,e){const a=u.slice();return a[6]=t[e],a[7]=t,a[8]=e,a}function te(u,t){let e,a,h,j,p,c,v,r,o,m,f,b,U,M,O,s,i,l,q,F,D,B,L,I,A,H=ke,w,K,X;function Y(...g){return t[3](t[6],t[7],t[8],...g)}function Z(){return t[4](t[6],t[7],t[8])}function z(){return t[5](t[6])}return{key:u,first:null,c(){e=E("div"),a=E("form"),h=E("input"),p=N(),c=E("button"),m=N(),f=E("form"),b=E("input"),M=N(),O=E("button"),i=N(),l=E("form"),q=E("button"),L=N(),this.h()},l(g){e=T(g,"DIV",{class:!0});var d=y(e);a=T(d,"FORM",{action:!0,method:!0});var P=y(a);h=T(P,"INPUT",{type:!0,name:!0,class:!0}),p=R(P),c=T(P,"BUTTON",{class:!0,"aria-label":!0}),y(c).forEach(k),P.forEach(k),m=R(d),f=T(d,"FORM",{class:!0,action:!0,method:!0});var S=y(f);b=T(S,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),M=R(S),O=T(S,"BUTTON",{class:!0,"aria-label":!0}),y(O).forEach(k),S.forEach(k),i=R(d),l=T(d,"FORM",{action:!0,method:!0});var G=y(l);q=T(G,"BUTTON",{class:!0,"aria-label":!0}),y(q).forEach(k),G.forEach(k),L=R(d),d.forEach(k),this.h()},h(){n(h,"type","hidden"),n(h,"name","done"),h.value=j=t[6].done?"":"true",n(h,"class","svelte-6t0qfp"),n(c,"class","toggle svelte-6t0qfp"),n(c,"aria-label",v="Mark todo as "+(t[6].done?"not done":"done")),n(a,"action",r="/todos/"+t[6].uid+".json?_method=patch"),n(a,"method","post"),n(b,"aria-label","Edit todo"),n(b,"type","text"),n(b,"name","text"),b.value=U=t[6].text,n(b,"class","svelte-6t0qfp"),n(O,"class","save svelte-6t0qfp"),n(O,"aria-label","Save todo"),n(f,"class","text svelte-6t0qfp"),n(f,"action",s="/todos/"+t[6].uid+".json?_method=patch"),n(f,"method","post"),n(q,"class","delete svelte-6t0qfp"),n(q,"aria-label","Delete todo"),q.disabled=F=t[6].pending_delete,n(l,"action",D="/todos/"+t[6].uid+".json?_method=delete"),n(l,"method","post"),n(e,"class","todo svelte-6t0qfp"),J(e,"done",t[6].done),this.first=e},m(g,d){Q(g,e,d),_(e,a),_(a,h),_(a,p),_(a,c),_(e,m),_(e,f),_(f,b),_(f,M),_(f,O),_(e,i),_(e,l),_(l,q),_(e,L),w=!0,K||(X=[V(o=C.call(null,a,{pending:Y,result:t[1]})),V(C.call(null,f,{result:t[1]})),V(B=C.call(null,l,{pending:Z,result:z}))],K=!0)},p(g,d){t=g,(!w||d&1&&j!==(j=t[6].done?"":"true"))&&(h.value=j),(!w||d&1&&v!==(v="Mark todo as "+(t[6].done?"not done":"done")))&&n(c,"aria-label",v),(!w||d&1&&r!==(r="/todos/"+t[6].uid+".json?_method=patch"))&&n(a,"action",r),o&&W(o.update)&&d&1&&o.update.call(null,{pending:Y,result:t[1]}),(!w||d&1&&U!==(U=t[6].text)&&b.value!==U)&&(b.value=U),(!w||d&1&&s!==(s="/todos/"+t[6].uid+".json?_method=patch"))&&n(f,"action",s),(!w||d&1&&F!==(F=t[6].pending_delete))&&(q.disabled=F),(!w||d&1&&D!==(D="/todos/"+t[6].uid+".json?_method=delete"))&&n(l,"action",D),B&&W(B.update)&&d&1&&B.update.call(null,{pending:Z,result:z}),d&1&&J(e,"done",t[6].done)},r(){A=e.getBoundingClientRect()},f(){le(e),H(),se(e,A)},a(){H(),H=re(e,A,ve,{duration:200})},i(g){w||(g&&ie(()=>{I||(I=$(e,x,{start:.7},!0)),I.run(1)}),w=!0)},o(g){g&&(I||(I=$(e,x,{start:.7},!1)),I.run(0)),w=!1},d(g){g&&k(e),g&&I&&I.end(),K=!1,ue(X)}}}function je(u){let t,e,a,h,j,p,c,v,r,o=[],m=new Map,f,b,U,M=u[0];const O=s=>s[6].uid;for(let s=0;s<M.length;s+=1){let i=ee(u,M,s),l=O(i);m.set(l,o[s]=te(l,i))}return{c(){t=N(),e=E("div"),a=E("h1"),h=de("Todos"),j=N(),p=E("form"),c=E("input"),r=N();for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){ce('[data-svelte="svelte-181o7gf"]',document.head).forEach(k),t=R(s),e=T(s,"DIV",{class:!0});var l=y(e);a=T(l,"H1",{});var q=y(a);h=fe(q,"Todos"),q.forEach(k),j=R(l),p=T(l,"FORM",{class:!0,action:!0,method:!0});var F=y(p);c=T(F,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),F.forEach(k),r=R(l);for(let D=0;D<o.length;D+=1)o[D].l(l);l.forEach(k),this.h()},h(){document.title="Todos",n(c,"name","text"),n(c,"aria-label","Add todo"),n(c,"placeholder","+ tap to add a todo"),n(c,"class","svelte-6t0qfp"),n(p,"class","new svelte-6t0qfp"),n(p,"action","/todos.json"),n(p,"method","post"),n(e,"class","todos svelte-6t0qfp")},m(s,i){Q(s,t,i),Q(s,e,i),_(e,a),_(a,h),_(e,j),_(e,p),_(p,c),_(e,r);for(let l=0;l<o.length;l+=1)o[l].m(e,null);f=!0,b||(U=V(v=C.call(null,p,{result:u[2]})),b=!0)},p(s,[i]){if(v&&W(v.update)&&i&1&&v.update.call(null,{result:s[2]}),i&3){M=s[0],be();for(let l=0;l<o.length;l+=1)o[l].r();o=_e(o,i,O,1,s,M,m,e,ge,te,null,ee);for(let l=0;l<o.length;l+=1)o[l].a();he()}},i(s){if(!f){for(let i=0;i<M.length;i+=1)pe(o[i]);f=!0}},o(s){for(let i=0;i<o.length;i+=1)me(o[i]);f=!1},d(s){s&&k(t),s&&k(e);for(let i=0;i<o.length;i+=1)o[i].d();b=!1,U()}}}const qe=async({fetch:u})=>{const t=await u("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function Ee(u,t,e){let{todos:a}=t;async function h(r){const o=await r.json();e(0,a=a.map(m=>m.uid===o.uid?o:m))}const j=async(r,o)=>{const m=await r.json();e(0,a=[...a,m]),o.reset()},p=(r,o,m,f)=>{e(0,o[m].done=!!f.get("done"),a)},c=(r,o,m)=>e(0,o[m].pending_delete=!0,a),v=r=>{e(0,a=a.filter(o=>o.uid!==r.uid))};return u.$$set=r=>{"todos"in r&&e(0,a=r.todos)},[a,h,j,p,c,v]}class we extends ae{constructor(t){super();oe(this,t,Ee,je,ne,{todos:0})}}export{we as default,qe as load};
